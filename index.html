<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=2.0">
<meta charset="UTF-8">
<title>Play Sound Every X Minutes</title>
</head>
<body>
<h2>v1.0.0</h2>
<button onclick="startPlaying()">Start</button>
<br>
<button onclick="stopPlaying()">Stop</button>
<div id="timer">***</div>

<script>
let intervalID;
let countdownID;
let cycleTime = 60;
let timeLeft = cycleTime;
let wakeLock = null;

async function playSound() {
    const audio = new Audio('singing-bowl-gong-69238.mp3');
    audio.play();
}

function updateTimer() {
    let minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    document.getElementById('timer').textContent =
        (minutes < 10 ? '0' : '') + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
}

function countdown() {
    if (timeLeft === 0) {
        playSound();
        timeLeft = cycleTime; // reset timer
    } else {
        timeLeft--;
    }
    updateTimer();
}

async function startPlaying() {
    playSound();
    if ('wakeLock' in navigator) {
        wakeLock = await navigator.wakeLock.request("screen");
    }
    intervalID = setInterval(countdown, 1000); // update timer every second
}

async function stopPlaying() {
    clearInterval(intervalID);
    timeLeft = cycleTime;
    updateTimer();
    if (wakeLock !== null) {
        await wakeLock.release();
        wakeLock = null;
    }
}
updateTimer();
</script>

</body>
</html>
